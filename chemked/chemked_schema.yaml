# Common reference for authors' information
author:
  type: dict
  schema: &author
    ORCID:  # TODO: Write ORCID validator
      type: string
    name:
      required: true
      type: string
# Common reference for composition schema
composition: &composition
  type: list
  schema:
    type: dict
    schema:
      species:
        required: true
        type: string
      mole-fraction:
        required: true
        type: float
        min: 0.0
        max: 1.0
      InChI:
        required: true
        type: string
# Common reference for value-unit schema
value-unit: &value-unit
  type: dict
  isvalid_quantity: true
  schema:
    value:
      min: 0.0
      required: true
      type: float
    units:  # TODO: Write unit validator
      required: true
      type: string
      isunit: true
# Common reference for ignition-type
ignition-type: &ignition-type
  type: dict
  schema:
    target:
      required: true
      type: string
      allowed:
        - temperature
        - pressure
        - OH
        - OH*
        - CH
        - CH*
    type:
      allowed:
        - d/dt max
        - max
        - min
      required: true
      type: string

# Start the ChemKED schema
common-properties:
  type: dict
  schema:
    pressure: *value-unit
    ignition-type: *ignition-type
    composition: *composition
    pressure-rise: *value-unit
apparatus:
  required: true
  type: dict
  schema:
    kind:
      allowed:
        - shock tube
        - rapid compression machine
      required: true
      type: string
    institution:
      type: string
    facility:
      type: string
datapoints:
  required: true
  type: list
  schema:
    type: dict
    schema:
      pressure-rise: *value-unit
      compression-time: *value-unit
      pressure: *value-unit
      ignition-type: *ignition-type
      ignition-delay: *value-unit
      temperature: *value-unit
      composition: *composition
      volume-history:
        type: dict
        schema:
          volume:
            required: true
            type: dict
            schema:
              units:  # TODO: Write unit validator
                required: true
                type: string
              column:
                required: true
                type: integer
                allowed: [0, 1]
          time:
            required: true
            type: dict
            schema:
              units:  # TODO: Write unit validator
                required: true
                type: string
              column:
                required: true
                type: integer
                allowed: [0, 1]
          values:
            required: true
            type: list
            schema:
              type: list
              items:
                - type: float
                - type: float
reference:
  required: true
  type: dict
  schema:
    volume:
      min: 0
      required: true
      type: integer
    journal:
      required: true
      type: string
    doi:  # TODO: Write DOI validator
      type: string
    authors:
      type: list
      required: true
      schema:
        type: dict
        schema: *author
    detail:
      type: string
    year:
      min: 1600
      required: true
      type: integer
    pages:
      required: true
      type: string
chemked-version:  # TODO: Implement proper version comparison
  allowed: 0.0.1
  required: true
  type: string
experiment-type:
  allowed:
    - ignition delay
  required: true
  type: string
file-author:
  type: dict
  required: true
  schema: *author
file-version:
  required: true
  type: string
